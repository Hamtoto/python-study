# Face Tracking 기반 발화 구간 영상 생성 시스템 요구사항 정의서

## 1. 개요

### 1.1 문서 목적
본 문서는 영상 내 인물의 얼굴을 트래킹하고, 해당 인물의 발화 구간만을 추출하여 얼굴 중심 영상으로 저장하는 시스템을 구현하기 위한 **요구사항 정의서**입니다. 해당 시스템은 특히 1인 또는 2인 화자가 등장하는 영상에서 발화자 중심의 요약 영상을 자동으로 생성하기 위해 기획되었습니다.

### 1.2 배경 및 필요성
- 회의, 강연, 콘텐츠 영상 등에서 발화자 중심 클립이 필요한 경우가 많음
- 수시간 분량의 영상에서 사람의 얼굴과 말하는 부분만 분리 추출하는 자동화 수요 증가
- 다중화자가 등장하더라도 명확한 분리 기준 없이 실용적인 추출 방식이 필요함


---

## 2. 시스템 개요

### 2.1 목표 시스템
- 영상 내에서 사람 얼굴을 자동 인식하고 트래킹
- 음성 분석(VAD)을 통해 말하는 구간만 추출
- 발화 구간 내 얼굴 중심 프레임을 250x250 해상도로 크롭
- 최종적으로 오디오와 프레임을 동기화한 영상 클립을 10초 단위로 분할 저장

### 2.2 사용 대상자
- 영상 후처리 작업이 많은 운영자 및 에디터
- 인터뷰/강연/세미나 영상 담당자
- 교육 콘텐츠 제작자, 쇼츠 자동화 시스템 기획자 등


---

## 3. 기능 요구사항

### 3.1 공통 기능
| 기능 | 설명 |
|------|------|
| 영상 입력 처리 | 지정된 디렉토리에서 입력 영상 로딩 |
| 발화 구간 분석 | 오디오에서 VAD 기반으로 말하는 구간 추출 |
| 얼굴 인식 | 영상 프레임에서 얼굴 검출 및 트래킹 |
| 임베딩 분석 | face_id 식별을 위한 FaceNet 임베딩 활용 |
| 영상 크롭 | 트래킹된 얼굴을 기준으로 250x250로 잘라냄 |
| 오디오 싱크 | 크롭된 프레임과 오디오를 시간 정렬 처리 |
| 세그먼트 저장 | 결과 영상을 10초 단위로 저장 |

### 3.2 1인 화자 모드 (SINGLE)
| 기능 | 설명 |
|--------|------|
| 최빈 얼굴 추출 | 영상 전체에서 가장 많이 등장한 face_id 1개 추출 |
| 발화 구간 필터링 | 해당 face_id가 등장한 발화 구간만 추출 |
| 저장 구조 | `/output/single/` 하위에 저장 |

### 3.3 2인 화자 모드 (DUAL)
| 기능 | 설명 |
|--------|------|
| 발화 구간 내 빈도 기반 추정 | 각 발화 구간마다 등장한 face_id 빈도 측정 |
| 상위 2명 추정 | 각 구간에서 등장 빈도 상위 2명을 speaker_a, speaker_b로 간주 |
| 저장 분기 | 각 segment를 두 사람 이름으로 각각 저장 |
| 저장 구조 | `/output/speaker_a/`, `/output/speaker_b/` 하위에 저장 |


---

## 4. 비기능 요구사항

| 항목 | 설명 |
|------|------|
| 실행 환경 | Python 3.10 이상, CUDA 지원 GPU (RTX 3090 이상 권장) |
| 처리 속도 | 1시간짜리 영상 기준 평균 처리 시간 15분 이내 |
| GPU 메모리 사용량 | 32GB 중 80% 이내 |
| 확장성 | 향후 3인 이상 다중화자 분기 확장 가능 구조 |
| 안정성 | 얼굴 없음/발화 없음 예외 시 로그 기록 후 continue |


---

## 5. 예외 및 정책

| 상황 | 처리 정책 |
|--------|-------------|
| 발화 있음 + 얼굴 없음 | segment 저장 생략, 로그 기록 |
| 동일 face_id 없을 경우 | `unknown_000` 식으로 fallback 저장 가능 |
| 구간 너무 짧음 (< 1초) | 저장 생략 또는 병합 가능 (설정 옵션화 예정) |


---

## 6. 향후 고려사항 (요구 보류항목)
- pyannote.audio 외 WhisperX, AV-HuBERT 등으로 대체 가능성
- 실시간 스트리밍 영상 대응
- 입 모양 기반 lip-sync 모델과의 결합 (SyncNet 등)
- 저장 영상에 얼굴 박스 오버레이 기능 옵션화


---

## 7. 문서 이력
| 버전 | 작성일 | 작성자 | 주요 변경사항 |
|-------|---------|----------|----------------|
| v1.0 | 2025-08-01 | Ethan Ko | 최초 요구사항 정의 및 정식화 |

> 본 문서는 Face Tracking 기반 발화 구간 영상 처리 시스템 구축을 위한 요구사항 정의 문서입니다. 개발자는 이 문서를 기반으로 기능 정의서 및 시스템 사양서로 연계하여 구현을 수행할 수 있습니다.

